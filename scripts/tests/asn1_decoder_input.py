import socket
import time
import os
from kafka import KafkaProducer

# Currently set to oim-dev environment's ODE
KAFKA_BROKER = "172.29.11.116:9092"  # Replace with your Kafka broker address and port
KAFKA_TOPIC = "topic.Asn1DecoderInput"  # Replace with the Kafka topic you want to publish to
producer = KafkaProducer(bootstrap_servers=KAFKA_BROKER)

# MESSAGE = "<OdeAsn1Data><metadata><bsmSource>EV</bsmSource><logFileName>bsmTx.gz</logFileName><recordType>bsmTx</recordType><securityResultCode>success</securityResultCode><receivedMessageDetails><locationData><latitude>40.5659199</latitude><longitude>-105.031773</longitude><elevation>1456.1</elevation><speed>0.28</speed><heading>268.275</heading></locationData><rxSource>NA</rxSource></receivedMessageDetails><encodings><encodings><elementName>root</elementName><elementType>Ieee1609Dot2Data</elementType><encodingRule>COER</encodingRule></encodings><encodings><elementName>unsecuredData</elementName><elementType>MessageFrame</elementType><encodingRule>UPER</encodingRule></encodings></encodings><payloadType>us.dot.its.jpo.ode.model.OdeAsn1Payload</payloadType><serialId><streamId>fffda5e3-f6fc-4007-9a19-8b1e53794754</streamId><bundleSize>16</bundleSize><bundleId>0</bundleId><recordId>7</recordId><serialNumber>7</serialNumber></serialId><odeReceivedAt>2023-09-18T23:18:26.489467Z</odeReceivedAt><schemaVersion>6</schemaVersion><maxDurationTime>0</maxDurationTime><recordGeneratedAt>2018-05-01T15:13:55.396Z</recordGeneratedAt><recordGeneratedBy>OBU</recordGeneratedBy><sanitized>false</sanitized><odePacketID/><odeTimStartDateTime/><originIp/></metadata><payload><dataType>us.dot.its.jpo.ode.model.OdeHexByteArray</dataType><data><bytes>0014465284a9ea8c4f2326e260f5965c652f25311414100070000000fdfa1fa1007fff80005a0fa0007cc040ff2b4037ef71fffc0fe6bc044afcbfffc0fe783e940e3bfffcfffec800400120000235da5fd7f72880afc46273f760137e80834179d2ce9abefb3aaddf73892ee65aba28109def53b15481d278542634a1d72d66c9c9d1eca86ef845f46ce16a9e755726247deb3cf024c3aa48532db346d3d50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</bytes></data></payload></OdeAsn1Data>"
# MESSAGE = "<OdeAsn1Data><metadata><bsmSource>RV</bsmSource><logFileName/><recordType>bsmTx</recordType><securityResultCode>unknown</securityResultCode><receivedMessageDetails><locationData><latitude/><longitude/><elevation/><speed/><heading/></locationData><rxSource>RV</rxSource></receivedMessageDetails><encodings><encodings><elementName>root</elementName><elementType>Ieee1609Dot2Data</elementType><encodingRule>COER</encodingRule></encodings><encodings><elementName>unsecuredData</elementName><elementType>MessageFrame</elementType><encodingRule>UPER</encodingRule></encodings></encodings><payloadType>us.dot.its.jpo.ode.model.OdeAsn1Payload</payloadType><serialId><streamId>615961ac-58f1-42ac-98e1-8abbb0d3b131</streamId><bundleSize>1</bundleSize><bundleId>0</bundleId><recordId>0</recordId><serialNumber>0</serialNumber></serialId><odeReceivedAt>2023-09-19T17:07:30.847914Z</odeReceivedAt><schemaVersion>6</schemaVersion><maxDurationTime>0</maxDurationTime><recordGeneratedAt/><recordGeneratedBy/><sanitized>false</sanitized><odePacketID/><odeTimStartDateTime/><originIp>172.30.0.1</originIp></metadata><payload><dataType>us.dot.its.jpo.ode.model.OdeHexByteArray</dataType><data><bytes>0014464744A9EA8C6C8826E260F8965C653C253A1414100070000000FDFA1FA1007FFF80005A0FA0007CC040FF2E403B2F97FFFC0FE6EC047EFF1FFFC0FE7B3E974E5FFFFCFFFEC800400120000235DA5E0F396080AFC46273F760137E80837276D28AD605B71BA6F8F737702A2ABC0C566785DCC3DFAE23B414DE7144924C5FA5C4BDF2F389263EDB16E4108BDB930AA8F507C4E0418732E0805A707B6161</bytes></data></payload></OdeAsn1Data>"

MESSAGE = "<OdeAsn1Data><metadata><bsmSource>EV</bsmSource><logFileName>bsmTx_2023-09-18T22%3A41%3A25.374_2229401004593.gz</logFileName><recordType>bsmTx</recordType><securityResultCode>unknown</securityResultCode><receivedMessageDetails><locationData><latitude>40.4740337</latitude><longitude>-104.9692039</longitude><elevation>1496.5</elevation><speed>0</speed><heading>0</heading></locationData><rxSource>NA</rxSource></receivedMessageDetails><encodings><encodings><elementName>unsecuredData</elementName><elementType>MessageFrame</elementType><encodingRule>UPER</encodingRule></encodings></encodings><payloadType>us.dot.its.jpo.ode.model.OdeAsn1Payload</payloadType><serialId><streamId>7074ba3c-042b-48a3-b88e-1e6a82cfe464</streamId><bundleSize>33</bundleSize><bundleId>0</bundleId><recordId>26</recordId><serialNumber>26</serialNumber></serialId><odeReceivedAt>2023-09-18T23:51:35.120811Z</odeReceivedAt><schemaVersion>6</schemaVersion><maxDurationTime>0</maxDurationTime><recordGeneratedAt>2023-09-18T22:45:45.625Z</recordGeneratedAt><recordGeneratedBy>OBU</recordGeneratedBy><sanitized>false</sanitized><odePacketID/><odeTimStartDateTime/><originIp/></metadata><payload><dataType>us.dot.its.jpo.ode.model.OdeHexByteArray</dataType><data><bytes>0014464744A9EA8C6C8826E260F8965C653C253A1414100070000000FDFA1FA1007FFF80005A0FA0007CC040FF2E403B2F97FFFC0FE6EC047EFF1FFFC0FE7B3E974E5FFFFCFFFEC800400120000235DA5E0F396080AFC46273F760137E80837276D28AD605B71BA6F8F737702A2ABC0C566785DCC3DFAE23B414DE7144924C5FA5C4BDF2F389263EDB16E4108BDB930AA8F507C4E0418732E0805A707B6161</bytes></data></payload></OdeAsn1Data>"


MESSAGE_BYTES = MESSAGE.encode('utf-8')
producer.send(KAFKA_TOPIC, value=MESSAGE_BYTES)
producer.close()
